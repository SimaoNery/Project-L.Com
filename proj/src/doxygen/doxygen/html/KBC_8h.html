<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LCOM Project: /Users/wagner/Desktop/faculdade/2 ano/LCOM/MINIX-LCOM/shared/g4/proj/src/drivers/mouse_keyboard/KBC.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LCOM Project
   </div>
   <div id="projectbrief">LCOM final project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('KBC_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">KBC.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;minix/sysutil.h&gt;</code><br />
<code>#include &lt;lcom/lcf.h&gt;</code><br />
<code>#include &quot;i8042.h&quot;</code><br />
<code>#include &quot;headers.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for KBC.h:</div>
<div class="dyncontent">
<div class="center"><img src="KBC_8h__incl.png" border="0" usemap="#a_2Users_2wagner_2Desktop_2faculdade_22_01ano_2LCOM_2MINIX-LCOM_2shared_2g4_2proj_2src_2drivers_2mouse__keyboard_2KBC_8h" alt=""/></div>
<map name="a_2Users_2wagner_2Desktop_2faculdade_22_01ano_2LCOM_2MINIX-LCOM_2shared_2g4_2proj_2src_2drivers_2mouse__keyboard_2KBC_8h" id="a_2Users_2wagner_2Desktop_2faculdade_22_01ano_2LCOM_2MINIX-LCOM_2shared_2g4_2proj_2src_2drivers_2mouse__keyboard_2KBC_8h">
<area shape="rect" title=" " alt="" coords="100,5,267,91"/>
<area shape="rect" title=" " alt="" coords="5,139,111,165"/>
<area shape="poly" title=" " alt="" coords="133,94,86,131,83,127,130,89"/>
<area shape="rect" title=" " alt="" coords="144,213,223,238"/>
<area shape="poly" title=" " alt="" coords="179,92,176,127,177,164,181,197,176,198,171,165,171,127,174,91"/>
<area shape="rect" href="i8042_8h_source.html" title=" " alt="" coords="186,139,250,165"/>
<area shape="poly" title=" " alt="" coords="200,90,212,124,207,125,195,92"/>
<area shape="rect" href="headers_8h_source.html" title=" " alt="" coords="274,139,352,165"/>
<area shape="poly" title=" " alt="" coords="239,89,287,127,284,132,235,94"/>
<area shape="poly" title=" " alt="" coords="215,166,198,200,194,197,210,164"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="KBC_8h__dep__incl.png" border="0" usemap="#a_2Users_2wagner_2Desktop_2faculdade_22_01ano_2LCOM_2MINIX-LCOM_2shared_2g4_2proj_2src_2drivers_2mouse__keyboard_2KBC_8hdep" alt=""/></div>
<map name="a_2Users_2wagner_2Desktop_2faculdade_22_01ano_2LCOM_2MINIX-LCOM_2shared_2g4_2proj_2src_2drivers_2mouse__keyboard_2KBC_8hdep" id="a_2Users_2wagner_2Desktop_2faculdade_22_01ano_2LCOM_2MINIX-LCOM_2shared_2g4_2proj_2src_2drivers_2mouse__keyboard_2KBC_8hdep">
<area shape="rect" title=" " alt="" coords="672,5,838,91"/>
<area shape="rect" href="KBC_8c_source.html" title=" " alt="" coords="421,139,588,225"/>
<area shape="poly" title=" " alt="" coords="663,101,586,141,584,136,660,96"/>
<area shape="rect" href="keyboard_8h_source.html" title=" " alt="" coords="612,139,778,225"/>
<area shape="poly" title=" " alt="" coords="732,106,717,140,712,138,727,104"/>
<area shape="rect" href="project_8h.html" title=" " alt="" coords="672,280,838,351"/>
<area shape="poly" title=" " alt="" coords="783,105,792,138,798,182,792,225,774,281,769,279,787,224,792,182,787,140,778,106"/>
<area shape="rect" href="mouse_8h_source.html" title=" " alt="" coords="1464,540,1630,626"/>
<area shape="poly" title=" " alt="" coords="854,63,1005,99,1094,128,1187,164,1280,209,1369,263,1450,328,1487,365,1520,405,1538,437,1548,472,1553,508,1553,539,1548,539,1547,508,1543,473,1533,439,1516,408,1483,369,1447,332,1366,268,1277,213,1185,169,1092,133,1003,104,853,68"/>
<area shape="rect" href="keyboard_8c_source.html" title=" " alt="" coords="481,273,648,358"/>
<area shape="poly" title=" " alt="" coords="645,237,608,274,604,270,641,234"/>
<area shape="poly" title=" " alt="" coords="723,238,742,279,737,281,718,240"/>
<area shape="rect" href="graphics_8h_source.html" title=" " alt="" coords="1293,406,1460,492"/>
<area shape="poly" title=" " alt="" coords="854,325,1051,353,1164,376,1276,404,1294,409,1292,415,1274,409,1163,381,1050,359,854,330"/>
<area shape="rect" href="draw_8h_source.html" title=" " alt="" coords="5,681,172,752"/>
<area shape="poly" title=" " alt="" coords="658,358,648,361,602,368,543,371,407,372,337,374,273,380,219,391,179,409,150,435,127,468,109,504,97,543,84,619,84,681,78,681,79,618,91,542,104,502,122,465,146,432,176,404,218,385,273,374,337,369,407,367,543,366,601,363,647,356,657,353"/>
<area shape="rect" href="command__line_8h_source.html" title=" " alt="" coords="201,406,384,492"/>
<area shape="poly" title=" " alt="" coords="666,359,660,361,588,378,531,386,474,393,403,409,385,414,383,409,401,404,473,388,530,381,587,373,658,356,664,354"/>
<area shape="rect" href="keyboard__handler_8h_source.html" title=" " alt="" coords="343,540,522,626"/>
<area shape="poly" title=" " alt="" coords="658,357,648,361,618,368,592,372,544,372,523,374,502,379,481,390,460,408,440,438,428,472,423,507,423,540,418,540,418,507,423,471,435,435,456,405,478,385,500,374,522,368,544,367,591,366,617,363,646,356,656,352"/>
<area shape="rect" href="mouse__handler_8h_source.html" title=" " alt="" coords="481,406,648,492"/>
<area shape="poly" title=" " alt="" coords="686,362,619,408,616,403,683,358"/>
<area shape="rect" href="timer__handler_8h_source.html" title=" " alt="" coords="672,406,838,492"/>
<area shape="poly" title=" " alt="" coords="749,366,749,406,744,406,744,366"/>
<area shape="rect" href="main_8c_source.html" title=" " alt="" coords="863,414,1029,485"/>
<area shape="poly" title=" " alt="" coords="819,358,897,411,894,415,816,362"/>
<area shape="rect" href="project_8c_source.html" title=" " alt="" coords="1053,414,1220,485"/>
<area shape="poly" title=" " alt="" coords="854,342,1041,404,1059,411,1057,416,1040,409,853,347"/>
<area shape="poly" title=" " alt="" coords="1444,499,1494,538,1491,542,1441,503"/>
<area shape="rect" href="graphics_8c_source.html" title=" " alt="" coords="1273,540,1440,626"/>
<area shape="poly" title=" " alt="" coords="1370,508,1366,540,1360,539,1365,507"/>
<area shape="rect" href="sprite_8h_source.html" title=" " alt="" coords="1083,548,1249,618"/>
<area shape="poly" title=" " alt="" coords="1298,503,1223,549,1220,545,1295,498"/>
<area shape="poly" title=" " alt="" coords="1535,526,1526,495,1513,463,1494,433,1470,408,1422,384,1354,364,1271,349,1180,338,994,324,838,320,839,314,994,319,1181,332,1272,344,1355,359,1424,379,1473,404,1498,430,1517,460,1531,493,1540,524"/>
<area shape="rect" href="mouse_8c_source.html" title=" " alt="" coords="1464,674,1630,759"/>
<area shape="poly" title=" " alt="" coords="1550,641,1550,673,1545,673,1545,641"/>
<area shape="poly" title=" " alt="" coords="1204,534,1224,503,1238,470,1242,437,1238,422,1229,408,1204,388,1166,371,1117,358,1062,346,945,331,839,323,839,317,945,326,1063,341,1119,352,1167,366,1207,384,1233,405,1243,420,1247,437,1244,471,1229,506,1209,537"/>
<area shape="poly" title=" " alt="" coords="1068,605,914,628,750,645,623,652,495,660,332,676,172,702,171,696,331,671,494,654,622,647,750,639,913,623,1067,600"/>
<area shape="rect" href="sprite_8c_source.html" title=" " alt="" coords="1083,681,1249,752"/>
<area shape="poly" title=" " alt="" coords="1169,634,1169,681,1163,681,1163,634"/>
<area shape="poly" title=" " alt="" coords="93,665,101,603,118,530,131,494,149,460,172,430,200,404,242,385,297,374,361,369,431,367,567,366,625,363,671,356,693,349,694,354,672,361,626,368,567,371,431,372,361,374,297,380,243,391,203,409,176,433,153,463,136,496,123,532,106,604,98,666"/>
<area shape="rect" href="draw_8c_source.html" title=" " alt="" coords="5,807,172,878"/>
<area shape="poly" title=" " alt="" coords="91,767,91,807,86,807,86,767"/>
<area shape="rect" href="command__line_8c_source.html" title=" " alt="" coords="137,540,320,626"/>
<area shape="poly" title=" " alt="" coords="268,507,251,541,247,538,263,505"/>
<area shape="poly" title=" " alt="" coords="350,501,390,538,386,542,346,504"/>
<area shape="poly" title=" " alt="" coords="437,524,448,462,461,431,480,405,502,385,524,374,546,368,568,367,615,366,641,363,670,356,689,349,691,354,672,361,642,368,616,372,568,372,547,374,526,379,505,390,484,408,465,434,454,464,443,525"/>
<area shape="rect" href="keyboard__handler_8c_source.html" title=" " alt="" coords="343,674,522,759"/>
<area shape="poly" title=" " alt="" coords="435,641,435,673,430,673,430,641"/>
<area shape="poly" title=" " alt="" coords="645,395,712,349,715,353,648,399"/>
<area shape="rect" href="mouse__handler_8c_source.html" title=" " alt="" coords="545,540,712,626"/>
<area shape="poly" title=" " alt="" coords="594,505,610,538,606,541,589,507"/>
<area shape="poly" title=" " alt="" coords="761,390,761,351,766,351,767,390"/>
<area shape="rect" href="timer__handler_8c_source.html" title=" " alt="" coords="736,540,902,626"/>
<area shape="poly" title=" " alt="" coords="785,505,801,538,796,541,780,507"/>
</map>
</div>
</div>
<p><a href="KBC_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1ea22dc7f1cd587ad7715408bddb3c4e" id="r_a1ea22dc7f1cd587ad7715408bddb3c4e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ea22dc7f1cd587ad7715408bddb3c4e">get_kbc_status</a> (uint8_t *status)</td></tr>
<tr class="memdesc:a1ea22dc7f1cd587ad7715408bddb3c4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the status from the Keyboard Controller (KBC).  <br /></td></tr>
<tr class="separator:a1ea22dc7f1cd587ad7715408bddb3c4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94335c781bc61e7e5f97dbaff386a411" id="r_a94335c781bc61e7e5f97dbaff386a411"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94335c781bc61e7e5f97dbaff386a411">write_kbc_cmd</a> (uint8_t port, uint8_t cmd)</td></tr>
<tr class="memdesc:a94335c781bc61e7e5f97dbaff386a411"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a command to the specified port of the Keyboard Controller (KBC).  <br /></td></tr>
<tr class="separator:a94335c781bc61e7e5f97dbaff386a411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74c91a5585cbcb4923357f837ef9d961" id="r_a74c91a5585cbcb4923357f837ef9d961"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74c91a5585cbcb4923357f837ef9d961">read_kbc_output</a> (uint8_t port, uint8_t *output, bool mouse)</td></tr>
<tr class="memdesc:a74c91a5585cbcb4923357f837ef9d961"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the output from the specified port of the Keyboard Controller (KBC).  <br /></td></tr>
<tr class="separator:a74c91a5585cbcb4923357f837ef9d961"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>wagner </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024-06-02</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2024 </dd></dl>

<p class="definition">Definition in file <a class="el" href="KBC_8h_source.html">KBC.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1ea22dc7f1cd587ad7715408bddb3c4e" name="a1ea22dc7f1cd587ad7715408bddb3c4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ea22dc7f1cd587ad7715408bddb3c4e">&#9670;&#160;</a></span>get_kbc_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_kbc_status </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>status</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the status from the Keyboard Controller (KBC). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">status</td><td>Pointer to a variable where the status will be stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Returns 0 upon success and 1 upon failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="KBC_8c_source.html#l00003">3</a> of file <a class="el" href="KBC_8c_source.html">KBC.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    3</span>                                      {</div>
<div class="line"><span class="lineno">    4</span>    <span class="keywordflow">if</span> (status == NULL) <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">    5</span> </div>
<div class="line"><span class="lineno">    6</span>    <span class="keywordflow">return</span> util_sys_inb(STATUS_REG, status);</div>
<div class="line"><span class="lineno">    7</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a74c91a5585cbcb4923357f837ef9d961" name="a74c91a5585cbcb4923357f837ef9d961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74c91a5585cbcb4923357f837ef9d961">&#9670;&#160;</a></span>read_kbc_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_kbc_output </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>port</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>mouse</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the output from the specified port of the Keyboard Controller (KBC). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>The port from which the output will be read. </td></tr>
    <tr><td class="paramname">output</td><td>Pointer to a variable where the output will be stored. </td></tr>
    <tr><td class="paramname">mouse</td><td>Boolean indicating whether the output is from the mouse (true) or keyboard (false). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Returns 0 upon success and 1 upon failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="KBC_8c_source.html#l00030">30</a> of file <a class="el" href="KBC_8c_source.html">KBC.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   30</span>                                                             {</div>
<div class="line"><span class="lineno">   31</span>  uint8_t status;</div>
<div class="line"><span class="lineno">   32</span>  <span class="keywordtype">int</span> attemps = 0;</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>  <span class="keywordflow">while</span> (attemps &lt; ATTEMPTS) {</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">if</span> (get_kbc_status(&amp;status)) <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>    <span class="keywordflow">if</span> (status &amp; BIT(0)) {</div>
<div class="line"><span class="lineno">   38</span>      <span class="keywordflow">if</span> (status &amp; BIT(7)) {</div>
<div class="line"><span class="lineno">   39</span>        printf(<span class="stringliteral">&quot;Parity bit is 1 -&gt; ERROR\n&quot;</span>);</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   41</span>      }</div>
<div class="line"><span class="lineno">   42</span>      <span class="keywordflow">if</span> (status &amp; BIT(6)) {</div>
<div class="line"><span class="lineno">   43</span>        printf(<span class="stringliteral">&quot;Timeout bit is 1 -&gt; ERROR\n&quot;</span>);</div>
<div class="line"><span class="lineno">   44</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   45</span>      }</div>
<div class="line"><span class="lineno">   46</span>      <span class="keywordflow">if</span> ((status &amp; BIT(5)) &amp;&amp; !mouse) {</div>
<div class="line"><span class="lineno">   47</span>        printf(<span class="stringliteral">&quot;Message to Mouse, wanted Keyboard -&gt; ERROR\n&quot;</span>);</div>
<div class="line"><span class="lineno">   48</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   49</span>      }</div>
<div class="line"><span class="lineno">   50</span>      <span class="keywordflow">if</span> (!(status &amp; BIT(5)) &amp;&amp; mouse) {</div>
<div class="line"><span class="lineno">   51</span>       printf(<span class="stringliteral">&quot;Message to Keyboard, wanted Mouse -&gt; ERROR\n&quot;</span>);</div>
<div class="line"><span class="lineno">   52</span>       <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   53</span>      }</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>      <span class="keywordflow">return</span> util_sys_inb(port, of);</div>
<div class="line"><span class="lineno">   56</span>    }</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    tickdelay(micros_to_ticks(DELAY_US));</div>
<div class="line"><span class="lineno">   59</span>    attemps++;</div>
<div class="line"><span class="lineno">   60</span>  }</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   63</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a94335c781bc61e7e5f97dbaff386a411" name="a94335c781bc61e7e5f97dbaff386a411"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94335c781bc61e7e5f97dbaff386a411">&#9670;&#160;</a></span>write_kbc_cmd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_kbc_cmd </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>port</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>cmd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a command to the specified port of the Keyboard Controller (KBC). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>The port to which the command will be written. </td></tr>
    <tr><td class="paramname">cmd</td><td>The command to be written. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Returns 0 upon success and 1 upon failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="KBC_8c_source.html#l00010">10</a> of file <a class="el" href="KBC_8c_source.html">KBC.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   10</span>                                               {</div>
<div class="line"><span class="lineno">   11</span> </div>
<div class="line"><span class="lineno">   12</span>  uint8_t status;</div>
<div class="line"><span class="lineno">   13</span>  <span class="keywordtype">int</span> attempts = 0;</div>
<div class="line"><span class="lineno">   14</span> </div>
<div class="line"><span class="lineno">   15</span>  <span class="keywordflow">while</span>(attempts &lt; ATTEMPTS) {</div>
<div class="line"><span class="lineno">   16</span>    <span class="keywordflow">if</span> (get_kbc_status(&amp;status)) <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   17</span> </div>
<div class="line"><span class="lineno">   18</span>    <span class="keywordflow">if</span> ((status &amp; BIT(1)) == 0) {</div>
<div class="line"><span class="lineno">   19</span>      <span class="keywordflow">return</span> sys_outb(port, cmd);</div>
<div class="line"><span class="lineno">   20</span>    }</div>
<div class="line"><span class="lineno">   21</span>    </div>
<div class="line"><span class="lineno">   22</span>    tickdelay(micros_to_ticks(DELAY_US));</div>
<div class="line"><span class="lineno">   23</span>    attempts++;</div>
<div class="line"><span class="lineno">   24</span>  }</div>
<div class="line"><span class="lineno">   25</span> </div>
<div class="line"><span class="lineno">   26</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   27</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_14bc92f4b96c8519b376567118ac28b3.html">drivers</a></li><li class="navelem"><a class="el" href="dir_938f7eeae6d183a9105117163887a783.html">mouse_keyboard</a></li><li class="navelem"><a class="el" href="KBC_8h.html">KBC.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
